{% extends 'auth/base.html' %}

{% block title %}Login - AI Directory{% endblock %}

{% block menu %}
{% include 'navbar.html' %}
{% endblock %}

{% block content %}
<div class="auth-header">
    <div class="auth-logo">
        <i class="fas fa-robot"></i>
    </div>
    <h1 class="auth-title">Welcome Back to Obtain.AI</h1>
    <p class="auth-subtitle">Sign in to your AI Directory account</p>
</div>

{% if messages %}
{% for message in messages %}
<div class="alert alert-{{ message.tags }}">
    {{ message }}
</div>
{% endfor %}
{% endif %}

<div class="container">
    <div class="row">
        <div class="col-md-6 mx-auto">
            <form method="post" novalidate>
                {% csrf_token %}

                <div class="form-group">
                    <label for="username" class="form-label">Username or Email</label>
                    <div class="input-group">
                        <span class="input-group-text">
                            <i class="fas fa-user"></i>
                        </span>
                        <input type="text" class="form-control with-icon shadow-none" id="username" name="username"
                            value="{{ form.username.value|default:'' }}" placeholder="Enter your username or email"
                            required>
                    </div>
                    {% if form.username.errors %}
                    <div class="text-danger small mt-1">
                        {% for error in form.username.errors %}
                        {{ error }}
                        {% endfor %}
                    </div>
                    {% endif %}
                </div>

                <div class="form-group">
                    <label for="password" class="form-label">Password</label>
                    <div class="input-group">
                        <span class="input-group-text">
                            <i class="fas fa-lock"></i>
                        </span>
                        <input type="password" class="form-control with-icon shadow-none" id="password" name="password"
                            placeholder="Enter your password" required>
                        <button type="button" class="password-toggle" onclick="togglePassword('password', this)">
                            <i class="fas fa-eye"></i>
                        </button>
                    </div>
                    {% if form.password.errors %}
                    <div class="text-danger small mt-1">
                        {% for error in form.password.errors %}
                        {{ error }}
                        {% endfor %}
                    </div>
                    {% endif %}
                </div>

                <div class="form-check">
                    <input class="form-check-input" type="checkbox" id="remember_me" name="remember_me">
                    <label class="form-check-label" for="remember_me">
                        Remember me for 30 days
                    </label>
                </div>

                <button type="submit" class="btn btn-primary">
                    <i class="fas fa-sign-in-alt me-2"></i>Sign In
                </button>
            </form>
        </div>
    </div>

</div>



<!-- <div class="auth-divider">
    <span>or continue with</span>
</div>

<button class="btn btn-social">
    <i class="fab fa-google"></i>Continue with Google
</button>

<button class="btn btn-social">
    <i class="fab fa-github"></i>Continue with GitHub
</button> -->

<div class="auth-footer">
    <p class="text-muted mb-2">
        <a href="{% url 'forgot_password' %}">Forgot your password?</a>
    </p>
    <p class="text-muted">
        Don't have an account?
        <a href="{% url 'signup' %}">Create one here</a>
    </p>
</div>
{% endblock %}

{% block footer %}
{% include 'footer.html' %}
{% endblock %}

{% block extra_js %}
<script>
    // Auto-focus on username field
    document.addEventListener('DOMContentLoaded', function () {
        document.getElementById('username').focus();
    });

    // Form validation
    document.querySelector('form').addEventListener('submit', function (e) {
        const username = document.getElementById('username').value.trim();
        const password = document.getElementById('password').value;

        if (!username) {
            e.preventDefault();
            showError('Please enter your username or email');
            return;
        }

        if (!password) {
            e.preventDefault();
            showError('Please enter your password');
            return;
        }

        // if (password.length < 6) {
        //     e.preventDefault();
        //     showError('Password must be at least 6 characters long');
        //     return;
        // }
    });

    function showError(message) {
        // Remove existing alerts
        const existingAlerts = document.querySelectorAll('.alert');
        existingAlerts.forEach(alert => alert.remove());

        // Create new alert
        const alert = document.createElement('div');
        alert.className = 'alert alert-danger';
        alert.textContent = message;

        // Insert before form
        const form = document.querySelector('form');
        form.parentNode.insertBefore(alert, form);

        // Auto-dismiss after 5 seconds
        setTimeout(() => {
            alert.style.opacity = '0';
            setTimeout(() => alert.remove(), 300);
        }, 5000);
    }
</script>
{% endblock %}