{% extends 'auth/base.html' %}

{% block title %}Forgot Password - AI Directory{% endblock %}

{% block content %}
<div class="auth-header">
    <div class="auth-logo">
        <i class="fas fa-key"></i>
    </div>
    <h1 class="auth-title">Forgot Password?</h1>
    <p class="auth-subtitle">Enter your email to reset your password</p>
</div>

{% if messages %}
    {% for message in messages %}
        <div class="alert alert-{{ message.tags }}">
            {{ message }}
        </div>
    {% endfor %}
{% endif %}

<form method="post" novalidate>
    {% csrf_token %}
    
    <div class="form-group">
        <label for="email" class="form-label">Email Address</label>
        <div class="input-group">
            <span class="input-group-text">
                <i class="fas fa-envelope"></i>
            </span>
            <input type="email" 
                   class="form-control with-icon" 
                   id="email" 
                   name="email" 
                   value="{{ form.email.value|default:'' }}"
                   placeholder="Enter your email address"
                   required>
        </div>
        <small class="text-muted">We'll send you a link to reset your password</small>
        {% if form.email.errors %}
            <div class="text-danger small mt-1">
                {% for error in form.email.errors %}
                    {{ error }}
                {% endfor %}
            </div>
        {% endif %}
    </div>

    <button type="submit" class="btn btn-primary">
        <i class="fas fa-paper-plane me-2"></i>Send Reset Link
    </button>
</form>

<div class="auth-footer">
    <p class="text-muted">
        Remember your password? 
        <a href="{% url 'auth:login' %}">Sign in here</a>
    </p>
    <p class="text-muted">
        Don't have an account? 
        <a href="{% url 'auth:signup' %}">Create one here</a>
    </p>
</div>
{% endblock %}

{% block extra_js %}
<script>
    // Auto-focus on email field
    document.addEventListener('DOMContentLoaded', function() {
        document.getElementById('email').focus();
    });

    // Form validation
    document.querySelector('form').addEventListener('submit', function(e) {
        const email = document.getElementById('email').value.trim();
        
        if (!email) {
            e.preventDefault();
            showError('Please enter your email address');
            return;
        }
        
        if (!isValidEmail(email)) {
            e.preventDefault();
            showError('Please enter a valid email address');
            return;
        }
    });

    function isValidEmail(email) {
        const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        return emailRegex.test(email);
    }

    function showError(message) {
        // Remove existing alerts
        const existingAlerts = document.querySelectorAll('.alert');
        existingAlerts.forEach(alert => alert.remove());
        
        // Create new alert
        const alert = document.createElement('div');
        alert.className = 'alert alert-danger';
        alert.textContent = message;
        
        // Insert before form
        const form = document.querySelector('form');
        form.parentNode.insertBefore(alert, form);
        
        // Auto-dismiss after 5 seconds
        setTimeout(() => {
            alert.style.opacity = '0';
            setTimeout(() => alert.remove(), 300);
        }, 5000);
    }
</script>
{% endblock %}

